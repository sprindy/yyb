<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>nRF51822 Beacon Firmware Documentation: Device Firmware Update Service</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF51822 Beacon Firmware Documentation
   &#160;<span id="projectnumber">v1.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__ble__sdk__srv__dfu.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Device Firmware Update Service</div>  </div>
</div><!--header-->
<div class="contents">

<p>Device Firmware Update Service.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structble__dfu__pkt__write__t.html">ble_dfu_pkt_write_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU Packet structure.  <a href="structble__dfu__pkt__write__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structble__pkt__rcpt__notif__req__t.html">ble_pkt_rcpt_notif_req_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packet receipt notification request structure.  <a href="structble__pkt__rcpt__notif__req__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structble__dfu__evt__t.html">ble_dfu_evt_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU Event structure.  <a href="structble__dfu__evt__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structble__dfu__s.html">ble_dfu_s</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU service structure.  <a href="structble__dfu__s.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structble__dfu__init__t.html">ble_dfu_init_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU service initialization structure.  <a href="structble__dfu__init__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga1e7a6fccfdd1670cff7559b4f9e86dab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga1e7a6fccfdd1670cff7559b4f9e86dab">BLE_DFU_SERVICE_UUID</a>&#160;&#160;&#160;0x1530</td></tr>
<tr class="separator:ga1e7a6fccfdd1670cff7559b4f9e86dab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81add6c06bce99096b28e6dce865656b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga81add6c06bce99096b28e6dce865656b">BLE_DFU_PKT_CHAR_UUID</a>&#160;&#160;&#160;0x1532</td></tr>
<tr class="separator:ga81add6c06bce99096b28e6dce865656b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11ed6309b542001d0de47adf71bfc51d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga11ed6309b542001d0de47adf71bfc51d">BLE_DFU_CTRL_PT_UUID</a>&#160;&#160;&#160;0x1531</td></tr>
<tr class="separator:ga11ed6309b542001d0de47adf71bfc51d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88a3fd6be571cda31e8510de9f999be8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga88a3fd6be571cda31e8510de9f999be8">BLE_DFU_STATUS_REP_UUID</a>&#160;&#160;&#160;0x1533</td></tr>
<tr class="separator:ga88a3fd6be571cda31e8510de9f999be8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5bbca54e216388a31d33fa003b75117d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga5bbca54e216388a31d33fa003b75117d">BLE_DFU_REV_CHAR_UUID</a>&#160;&#160;&#160;0x1534</td></tr>
<tr class="separator:ga5bbca54e216388a31d33fa003b75117d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga03ad2477271b1db6cdcbf6285b5ccf3f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structble__dfu__s.html">ble_dfu_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a></td></tr>
<tr class="memdesc:ga03ad2477271b1db6cdcbf6285b5ccf3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU service structure.  <a href="#ga03ad2477271b1db6cdcbf6285b5ccf3f">More...</a><br/></td></tr>
<tr class="separator:ga03ad2477271b1db6cdcbf6285b5ccf3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c1ddf1bdd414c49f408f4ffd965fa00"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga4c1ddf1bdd414c49f408f4ffd965fa00">ble_dfu_evt_handler_t</a> )(<a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *p_dfu, <a class="el" href="structble__dfu__evt__t.html">ble_dfu_evt_t</a> *p_evt)</td></tr>
<tr class="memdesc:ga4c1ddf1bdd414c49f408f4ffd965fa00"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU Service event handler type.  <a href="#ga4c1ddf1bdd414c49f408f4ffd965fa00">More...</a><br/></td></tr>
<tr class="separator:ga4c1ddf1bdd414c49f408f4ffd965fa00"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gae3254bda56bfd26221277e8a1696a4b5"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#gae3254bda56bfd26221277e8a1696a4b5">ble_dfu_evt_type_t</a> { <br/>
&#160;&#160;<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a1cd5b94b536bc25cfb45cdb61b9c709f">BLE_DFU_START</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a5be4b8df677deabd7113748634358df3">BLE_DFU_RECEIVE_INIT_DATA</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5ac907d625d9e7c33dca02f1743331d24c">BLE_DFU_RECEIVE_APP_DATA</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a3df5efa7854ec1d5732e0e8adc832b46">BLE_DFU_VALIDATE</a>, 
<br/>
&#160;&#160;<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5afdf5ae3efb8a4af74123482bd550f67e">BLE_DFU_ACTIVATE_N_RESET</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5aea137924204da831e6ca6bc18dcf877f">BLE_DFU_SYS_RESET</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a3e439ee06700ce37e86c9d2300e84421">BLE_DFU_PKT_RCPT_NOTIF_ENABLED</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a91bdead0f698d2fb99368a1a7915b6dd">BLE_DFU_PKT_RCPT_NOTIF_DISABLED</a>, 
<br/>
&#160;&#160;<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5aedcdcc2fa4f3f0209fdbf3805fff2865">BLE_DFU_PACKET_WRITE</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5afbcdbbd6e91c10027a383ab2dd47ec80">BLE_DFU_BYTES_RECEIVED_SEND</a>
<br/>
 }</td></tr>
<tr class="memdesc:gae3254bda56bfd26221277e8a1696a4b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU Event type.  <a href="group__ble__sdk__srv__dfu.html#gae3254bda56bfd26221277e8a1696a4b5">More...</a><br/></td></tr>
<tr class="separator:gae3254bda56bfd26221277e8a1696a4b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c02cda322aae2f242e2ade7c8284cfc"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga8c02cda322aae2f242e2ade7c8284cfc">ble_dfu_procedure_t</a> { <br/>
&#160;&#160;<a class="el" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfcab142998d13fb320ca462d7b1a3a817c9">BLE_DFU_START_PROCEDURE</a> = 1, 
<a class="el" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfca4d599927936783c1113c316f478c7c8c">BLE_DFU_INIT_PROCEDURE</a> = 2, 
<a class="el" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfca37c2f6b73e2fbc65ba4c2a8fae85dd2e">BLE_DFU_RECEIVE_APP_PROCEDURE</a> = 3, 
<a class="el" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfcaa8545d7cc421ed4637c6a95a8178437d">BLE_DFU_VALIDATE_PROCEDURE</a> = 4, 
<br/>
&#160;&#160;<a class="el" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfca0378c3ced232f1d71ebb7bd15fab0958">BLE_DFU_PKT_RCPT_REQ_PROCEDURE</a> = 8
<br/>
 }</td></tr>
<tr class="memdesc:ga8c02cda322aae2f242e2ade7c8284cfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU Procedure type.  <a href="group__ble__sdk__srv__dfu.html#ga8c02cda322aae2f242e2ade7c8284cfc">More...</a><br/></td></tr>
<tr class="separator:ga8c02cda322aae2f242e2ade7c8284cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4373c9bf123c0fd7858aac7a75923a81"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga4373c9bf123c0fd7858aac7a75923a81">ble_dfu_resp_val_t</a> { <br/>
&#160;&#160;<a class="el" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a41c5cb143d8b4a872692b0c99078d14d">BLE_DFU_RESP_VAL_SUCCESS</a> = 1, 
<a class="el" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a32d406725831e1e6ee854fe1b3db8f80">BLE_DFU_RESP_VAL_INVALID_STATE</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81ab543d26f426831ba0a75ef5276d0c370">BLE_DFU_RESP_VAL_NOT_SUPPORTED</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a9c2aeed38374c47c55f912b2239838ff">BLE_DFU_RESP_VAL_DATA_SIZE</a>, 
<br/>
&#160;&#160;<a class="el" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81aadbf20d30047e2884daa2d0acaf280a7">BLE_DFU_RESP_VAL_CRC_ERROR</a>, 
<a class="el" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a773dc1a4192071f3a68388456bbd0e63">BLE_DFU_RESP_VAL_OPER_FAILED</a>
<br/>
 }</td></tr>
<tr class="memdesc:ga4373c9bf123c0fd7858aac7a75923a81"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU Response value type.  <a href="group__ble__sdk__srv__dfu.html#ga4373c9bf123c0fd7858aac7a75923a81">More...</a><br/></td></tr>
<tr class="separator:ga4373c9bf123c0fd7858aac7a75923a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga41b1425f99ffb9fff07ea41166cea6a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#ga41b1425f99ffb9fff07ea41166cea6a7">ble_dfu_on_ble_evt</a> (<a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *p_dfu, <a class="el" href="structble__evt__t.html">ble_evt_t</a> *p_ble_evt)</td></tr>
<tr class="memdesc:ga41b1425f99ffb9fff07ea41166cea6a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for handling a BLE event.  <a href="#ga41b1425f99ffb9fff07ea41166cea6a7">More...</a><br/></td></tr>
<tr class="separator:ga41b1425f99ffb9fff07ea41166cea6a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae07a32975c8366cda747a0734a3f43ea"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#gae07a32975c8366cda747a0734a3f43ea">ble_dfu_init</a> (<a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *p_dfu, <a class="el" href="structble__dfu__init__t.html">ble_dfu_init_t</a> *p_dfu_init)</td></tr>
<tr class="memdesc:gae07a32975c8366cda747a0734a3f43ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for initializing the DFU service.  <a href="#gae07a32975c8366cda747a0734a3f43ea">More...</a><br/></td></tr>
<tr class="separator:gae07a32975c8366cda747a0734a3f43ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7ddce358287772b50ae654138ff3ac5"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#gad7ddce358287772b50ae654138ff3ac5">ble_dfu_response_send</a> (<a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *p_dfu, <a class="el" href="group__ble__sdk__srv__dfu.html#ga8c02cda322aae2f242e2ade7c8284cfc">ble_dfu_procedure_t</a> dfu_proc, <a class="el" href="group__ble__sdk__srv__dfu.html#ga4373c9bf123c0fd7858aac7a75923a81">ble_dfu_resp_val_t</a> resp_val)</td></tr>
<tr class="memdesc:gad7ddce358287772b50ae654138ff3ac5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for sending response to a control point command.  <a href="#gad7ddce358287772b50ae654138ff3ac5">More...</a><br/></td></tr>
<tr class="separator:gad7ddce358287772b50ae654138ff3ac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaafc505a19500b0f629ff5210ff3e754d"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#gaafc505a19500b0f629ff5210ff3e754d">ble_dfu_bytes_rcvd_report</a> (<a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *p_dfu, uint32_t num_of_firmware_bytes_rcvd)</td></tr>
<tr class="memdesc:gaafc505a19500b0f629ff5210ff3e754d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for notifying the peer about the number of bytes of firmware data received.  <a href="#gaafc505a19500b0f629ff5210ff3e754d">More...</a><br/></td></tr>
<tr class="separator:gaafc505a19500b0f629ff5210ff3e754d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf6fde821bd72c16b61442d0627f4e50"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ble__sdk__srv__dfu.html#gadf6fde821bd72c16b61442d0627f4e50">ble_dfu_pkts_rcpt_notify</a> (<a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *p_dfu, uint32_t num_of_firmware_bytes_rcvd)</td></tr>
<tr class="memdesc:gadf6fde821bd72c16b61442d0627f4e50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for sending Packet Receipt Notification to the peer.  <a href="#gadf6fde821bd72c16b61442d0627f4e50">More...</a><br/></td></tr>
<tr class="separator:gadf6fde821bd72c16b61442d0627f4e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Device Firmware Update Service. </p>
<p>The Device Firmware Update (DFU) service is a GATT based service that can be used for performing firmware updates over BLE. Note that this implementation uses vendor specific UUIDs for service and characteristics and is intended to demonstrate the firmware updates over BLE. Refer ota_spec_sec and ota_profile_section for more information on the service and profile respectively. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga1e7a6fccfdd1670cff7559b4f9e86dab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLE_DFU_SERVICE_UUID&#160;&#160;&#160;0x1530</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The UUID of the DFU Service. </p>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00036">36</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga81add6c06bce99096b28e6dce865656b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLE_DFU_PKT_CHAR_UUID&#160;&#160;&#160;0x1532</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The UUID of the DFU Packet Characteristic. </p>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00037">37</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga11ed6309b542001d0de47adf71bfc51d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLE_DFU_CTRL_PT_UUID&#160;&#160;&#160;0x1531</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The UUID of the DFU Control Point. </p>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00038">38</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga88a3fd6be571cda31e8510de9f999be8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLE_DFU_STATUS_REP_UUID&#160;&#160;&#160;0x1533</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The UUID of the DFU Status Report Characteristic. </p>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00039">39</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga5bbca54e216388a31d33fa003b75117d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLE_DFU_REV_CHAR_UUID&#160;&#160;&#160;0x1534</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The UUID of the DFU Revision Characteristic. </p>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00040">40</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga03ad2477271b1db6cdcbf6285b5ccf3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structble__dfu__s.html">ble_dfu_s</a> <a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DFU service structure. </p>
<p>This structure contains status information related to the service. </p>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00124">124</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga4c1ddf1bdd414c49f408f4ffd965fa00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* ble_dfu_evt_handler_t)(<a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *p_dfu, <a class="el" href="structble__dfu__evt__t.html">ble_dfu_evt_t</a> *p_evt)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DFU Service event handler type. </p>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00127">127</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="gae3254bda56bfd26221277e8a1696a4b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__ble__sdk__srv__dfu.html#gae3254bda56bfd26221277e8a1696a4b5">ble_dfu_evt_type_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DFU Event type. </p>
<p>This enumeration contains the types of events that will be received from the DFU Service. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5a1cd5b94b536bc25cfb45cdb61b9c709f"></a>BLE_DFU_START</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer wants the application to prepare for a new firmware update. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5a5be4b8df677deabd7113748634358df3"></a>BLE_DFU_RECEIVE_INIT_DATA</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer wants the application to prepare to receive init parameters. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5ac907d625d9e7c33dca02f1743331d24c"></a>BLE_DFU_RECEIVE_APP_DATA</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer wants the application to prepare to receive the new firmware image. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5a3df5efa7854ec1d5732e0e8adc832b46"></a>BLE_DFU_VALIDATE</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer wants the application to validate the newly received firmware image. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5afdf5ae3efb8a4af74123482bd550f67e"></a>BLE_DFU_ACTIVATE_N_RESET</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer wants the application to undergo activate new firmware and restart with new valid application </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5aea137924204da831e6ca6bc18dcf877f"></a>BLE_DFU_SYS_RESET</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer wants the application to undergo a reset and start the currently valid application image. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5a3e439ee06700ce37e86c9d2300e84421"></a>BLE_DFU_PKT_RCPT_NOTIF_ENABLED</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer has enabled packet receipt notifications. It is the responsibility of the application to call <a class="el" href="group__ble__sdk__srv__dfu.html#gadf6fde821bd72c16b61442d0627f4e50">ble_dfu_pkts_rcpt_notify</a> each time the number of packets indicated by num_of_pkts field in <a class="el" href="structble__dfu__evt__t.html">ble_dfu_evt_t</a> is received. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5a91bdead0f698d2fb99368a1a7915b6dd"></a>BLE_DFU_PKT_RCPT_NOTIF_DISABLED</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer has disabled the packet receipt notifications. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5aedcdcc2fa4f3f0209fdbf3805fff2865"></a>BLE_DFU_PACKET_WRITE</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer has written a value to the 'DFU Packet' characteristic. The data received from the peer will be present in the <a class="el" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5aedcdcc2fa4f3f0209fdbf3805fff2865">BLE_DFU_PACKET_WRITE</a> element contained within <a class="el" href="structble__dfu__evt__t.html">ble_dfu_evt_t</a>. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggae3254bda56bfd26221277e8a1696a4b5afbcdbbd6e91c10027a383ab2dd47ec80"></a>BLE_DFU_BYTES_RECEIVED_SEND</em>&nbsp;</td><td class="fielddoc">
<p>The event indicating that the peer is requesting for the number of bytes of firmware data last received by the application. It is the responsibility of the application to call <a class="el" href="group__ble__sdk__srv__dfu.html#gadf6fde821bd72c16b61442d0627f4e50">ble_dfu_pkts_rcpt_notify</a> in response to this event. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00046">46</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a1cd5b94b536bc25cfb45cdb61b9c709f">BLE_DFU_START</a>,                                                      </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a5be4b8df677deabd7113748634358df3">BLE_DFU_RECEIVE_INIT_DATA</a>,                                          </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5ac907d625d9e7c33dca02f1743331d24c">BLE_DFU_RECEIVE_APP_DATA</a>,                                           </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a3df5efa7854ec1d5732e0e8adc832b46">BLE_DFU_VALIDATE</a>,                                                   </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5afdf5ae3efb8a4af74123482bd550f67e">BLE_DFU_ACTIVATE_N_RESET</a>,                                           </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5aea137924204da831e6ca6bc18dcf877f">BLE_DFU_SYS_RESET</a>,                                                  </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a3e439ee06700ce37e86c9d2300e84421">BLE_DFU_PKT_RCPT_NOTIF_ENABLED</a>,                                     </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5a91bdead0f698d2fb99368a1a7915b6dd">BLE_DFU_PKT_RCPT_NOTIF_DISABLED</a>,                                    </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5aedcdcc2fa4f3f0209fdbf3805fff2865">BLE_DFU_PACKET_WRITE</a>,                                               </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#ggae3254bda56bfd26221277e8a1696a4b5afbcdbbd6e91c10027a383ab2dd47ec80">BLE_DFU_BYTES_RECEIVED_SEND</a>                                         </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;} <a class="code" href="group__ble__sdk__srv__dfu.html#gae3254bda56bfd26221277e8a1696a4b5" title="DFU Event type. ">ble_dfu_evt_type_t</a>;</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8c02cda322aae2f242e2ade7c8284cfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__ble__sdk__srv__dfu.html#ga8c02cda322aae2f242e2ade7c8284cfc">ble_dfu_procedure_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DFU Procedure type. </p>
<p>This enumeration contains the types of DFU procedures. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="gga8c02cda322aae2f242e2ade7c8284cfcab142998d13fb320ca462d7b1a3a817c9"></a>BLE_DFU_START_PROCEDURE</em>&nbsp;</td><td class="fielddoc">
<p>DFU Start procedure. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga8c02cda322aae2f242e2ade7c8284cfca4d599927936783c1113c316f478c7c8c"></a>BLE_DFU_INIT_PROCEDURE</em>&nbsp;</td><td class="fielddoc">
<p>DFU Initialization procedure. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga8c02cda322aae2f242e2ade7c8284cfca37c2f6b73e2fbc65ba4c2a8fae85dd2e"></a>BLE_DFU_RECEIVE_APP_PROCEDURE</em>&nbsp;</td><td class="fielddoc">
<p>Firmware receiving procedure. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga8c02cda322aae2f242e2ade7c8284cfcaa8545d7cc421ed4637c6a95a8178437d"></a>BLE_DFU_VALIDATE_PROCEDURE</em>&nbsp;</td><td class="fielddoc">
<p>Firmware image validation procedure . </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga8c02cda322aae2f242e2ade7c8284cfca0378c3ced232f1d71ebb7bd15fab0958"></a>BLE_DFU_PKT_RCPT_REQ_PROCEDURE</em>&nbsp;</td><td class="fielddoc">
<p>Packet receipt notification request procedure. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00064">64</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfcab142998d13fb320ca462d7b1a3a817c9">BLE_DFU_START_PROCEDURE</a>        = 1,                                 </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfca4d599927936783c1113c316f478c7c8c">BLE_DFU_INIT_PROCEDURE</a>         = 2,                                 </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfca37c2f6b73e2fbc65ba4c2a8fae85dd2e">BLE_DFU_RECEIVE_APP_PROCEDURE</a>  = 3,                                 </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfcaa8545d7cc421ed4637c6a95a8178437d">BLE_DFU_VALIDATE_PROCEDURE</a>     = 4,                                 </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga8c02cda322aae2f242e2ade7c8284cfca0378c3ced232f1d71ebb7bd15fab0958">BLE_DFU_PKT_RCPT_REQ_PROCEDURE</a> = 8                                  </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;} <a class="code" href="group__ble__sdk__srv__dfu.html#ga8c02cda322aae2f242e2ade7c8284cfc" title="DFU Procedure type. ">ble_dfu_procedure_t</a>;</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4373c9bf123c0fd7858aac7a75923a81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__ble__sdk__srv__dfu.html#ga4373c9bf123c0fd7858aac7a75923a81">ble_dfu_resp_val_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DFU Response value type. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="gga4373c9bf123c0fd7858aac7a75923a81a41c5cb143d8b4a872692b0c99078d14d"></a>BLE_DFU_RESP_VAL_SUCCESS</em>&nbsp;</td><td class="fielddoc">
<p>Success. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga4373c9bf123c0fd7858aac7a75923a81a32d406725831e1e6ee854fe1b3db8f80"></a>BLE_DFU_RESP_VAL_INVALID_STATE</em>&nbsp;</td><td class="fielddoc">
<p>Invalid state. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga4373c9bf123c0fd7858aac7a75923a81ab543d26f426831ba0a75ef5276d0c370"></a>BLE_DFU_RESP_VAL_NOT_SUPPORTED</em>&nbsp;</td><td class="fielddoc">
<p>Operation not supported. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga4373c9bf123c0fd7858aac7a75923a81a9c2aeed38374c47c55f912b2239838ff"></a>BLE_DFU_RESP_VAL_DATA_SIZE</em>&nbsp;</td><td class="fielddoc">
<p>Data size exceeds limit. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga4373c9bf123c0fd7858aac7a75923a81aadbf20d30047e2884daa2d0acaf280a7"></a>BLE_DFU_RESP_VAL_CRC_ERROR</em>&nbsp;</td><td class="fielddoc">
<p>CRC Error. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga4373c9bf123c0fd7858aac7a75923a81a773dc1a4192071f3a68388456bbd0e63"></a>BLE_DFU_RESP_VAL_OPER_FAILED</em>&nbsp;</td><td class="fielddoc">
<p>Operation failed. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="ble__dfu_8h_source.html#l00075">75</a> of file <a class="el" href="ble__dfu_8h_source.html">ble_dfu.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a41c5cb143d8b4a872692b0c99078d14d">BLE_DFU_RESP_VAL_SUCCESS</a> = 1,                                       </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a32d406725831e1e6ee854fe1b3db8f80">BLE_DFU_RESP_VAL_INVALID_STATE</a>,                                     </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81ab543d26f426831ba0a75ef5276d0c370">BLE_DFU_RESP_VAL_NOT_SUPPORTED</a>,                                     </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a9c2aeed38374c47c55f912b2239838ff">BLE_DFU_RESP_VAL_DATA_SIZE</a>,                                         </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81aadbf20d30047e2884daa2d0acaf280a7">BLE_DFU_RESP_VAL_CRC_ERROR</a>,                                         </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a773dc1a4192071f3a68388456bbd0e63">BLE_DFU_RESP_VAL_OPER_FAILED</a>                                        </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;} <a class="code" href="group__ble__sdk__srv__dfu.html#ga4373c9bf123c0fd7858aac7a75923a81" title="DFU Response value type. ">ble_dfu_resp_val_t</a>;</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga41b1425f99ffb9fff07ea41166cea6a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ble_dfu_on_ble_evt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *&#160;</td>
          <td class="paramname"><em>p_dfu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structble__evt__t.html">ble_evt_t</a> *&#160;</td>
          <td class="paramname"><em>p_ble_evt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for handling a BLE event. </p>
<p>The DFU service expects the application to call this function each time an event is received from the S110 SoftDevice. This function processes the event, if it is relevant for the DFU service and calls the DFU event handler of the application if necessary.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dfu</td><td>Pointer to the DFU service structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_ble_evt</td><td>Pointer to the event received from S110 SoftDevice. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ble__dfu_8c_source.html#l00516">516</a> of file <a class="el" href="ble__dfu_8c_source.html">ble_dfu.c</a>.</p>

<p>References <a class="el" href="ble__gap_8h_source.html#l00439">BLE_GAP_EVT_CONNECTED</a>, <a class="el" href="ble__gap_8h_source.html#l00440">BLE_GAP_EVT_DISCONNECTED</a>, <a class="el" href="ble__gatts_8h_source.html#l00244">BLE_GATTS_EVT_RW_AUTHORIZE_REQUEST</a>, <a class="el" href="ble__gatts_8h_source.html#l00243">BLE_GATTS_EVT_WRITE</a>, <a class="el" href="ble__dfu_8h_source.html#l00143">ble_dfu_s::evt_handler</a>, <a class="el" href="ble_8h_source.html#l00134">ble_evt_hdr_t::evt_id</a>, <a class="el" href="ble_8h_source.html#l00141">ble_evt_t::header</a>, <a class="el" href="ble__dfu_8c_source.html#l00208">on_connect()</a>, <a class="el" href="ble__dfu_8c_source.html#l00441">on_disconnect()</a>, <a class="el" href="ble__dfu_8c_source.html#l00390">on_rw_auth_req()</a>, and <a class="el" href="ble__dfu_8c_source.html#l00419">on_write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;{</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span> ((p_dfu == NULL) || (p_ble_evt == NULL))</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a11147a19adf77be7ac28efef09fd6d69">evt_handler</a> != NULL)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">switch</span> (p_ble_evt-&gt;<a class="code" href="structble__evt__t.html#a50f33abba5627a26728ba30fffd9880a">header</a>.<a class="code" href="structble__evt__hdr__t.html#a826314e7ea25d4267621899efe6859f9">evt_id</a>)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group___b_l_e___g_a_p___s_t_r_u_c_t_u_r_e_s.html#ggada486dd3c0cce897b23a887bed284fefaa0b4789724d202a13a5e7eab85c52957">BLE_GAP_EVT_CONNECTED</a>:</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <a class="code" href="ble__dfu_8c.html#af8b2747de312138232d598a9b64efcf6" title="Function for handling the BLE_GAP_EVT_CONNECTED event from the S110 SoftDevice. ">on_connect</a>(p_dfu, p_ble_evt);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group___b_l_e___g_a_t_t_s___s_t_r_u_c_t_u_r_e_s.html#ggae537647902af1b05c1e32f12d6b401c7aa68b7764f5264ff092d2ad17851355ed">BLE_GATTS_EVT_WRITE</a>:</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <a class="code" href="ble__dfu_8c.html#aeb3de04ecba946e7efc92cf6b12689b7" title="Function for handling the BLE_GATTS_EVT_WRITE event from the S110 SoftDevice. ">on_write</a>(p_dfu, p_ble_evt);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group___b_l_e___g_a_p___s_t_r_u_c_t_u_r_e_s.html#ggada486dd3c0cce897b23a887bed284fefa057001bbd6ea9e615f19ef93cc0831ee">BLE_GAP_EVT_DISCONNECTED</a>:</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                <a class="code" href="ble__dfu_8c.html#a65475f0f7b24ed678963b76ec47ce66f" title="Function for handling the BLE_GAP_EVT_DISCONNECTED event from the S110 SoftDevice. ">on_disconnect</a>(p_dfu, p_ble_evt);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group___b_l_e___g_a_t_t_s___s_t_r_u_c_t_u_r_e_s.html#ggae537647902af1b05c1e32f12d6b401c7a333a0e896f77ea1c7f9a0e1e11f8240d">BLE_GATTS_EVT_RW_AUTHORIZE_REQUEST</a>:</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <a class="code" href="ble__dfu_8c.html#aed686be01a452dd4249ace4667d3164f" title="Function for handling the BLE_GATTS_EVT_RW_AUTHORIZE_REQUEST event from the S110 Stack. ">on_rw_auth_req</a>(p_dfu, p_ble_evt);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                <span class="comment">// No implementation needed.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae07a32975c8366cda747a0734a3f43ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ble_dfu_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *&#160;</td>
          <td class="paramname"><em>p_dfu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structble__dfu__init__t.html">ble_dfu_init_t</a> *&#160;</td>
          <td class="paramname"><em>p_dfu_init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for initializing the DFU service. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">p_dfu</td><td>Device Firmware Update service structure. This structure will have to be supplied by the application. It will be initialized by this function, and will later be used to identify the service instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dfu_init</td><td>Information needed to initialize the service.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NRF_SUCCESS if the DFU service and its characteristics were successfully added to the S110 SoftDevice. Otherwise an error code. This function returns NRF_ERROR_NULL if the value of evt_handler in p_dfu_init structure provided is NULL or if the pointers supplied as input are NULL. </dd></dl>

<p>Definition at line <a class="el" href="ble__dfu_8c_source.html#l00447">447</a> of file <a class="el" href="ble__dfu_8c_source.html">ble_dfu.c</a>.</p>

<p>References <a class="el" href="ble__types_8h_source.html#l00027">BLE_CONN_HANDLE_INVALID</a>, <a class="el" href="ble__dfu_8h_source.html#l00036">BLE_DFU_SERVICE_UUID</a>, <a class="el" href="ble__gatts_8h_source.html#l00068">BLE_GATTS_SRVC_TYPE_PRIMARY</a>, <a class="el" href="ble__dfu_8h_source.html#l00135">ble_dfu_s::conn_handle</a>, <a class="el" href="ble__dfu_8c_source.html#l00157">dfu_ctrl_pt_add()</a>, <a class="el" href="ble__dfu_8c_source.html#l00055">dfu_pkt_char_add()</a>, <a class="el" href="ble__dfu_8c_source.html#l00106">dfu_rev_char_add()</a>, <a class="el" href="ble__dfu_8h_source.html#l00144">ble_dfu_s::error_handler</a>, <a class="el" href="ble__dfu_8h_source.html#l00157">ble_dfu_init_t::error_handler</a>, <a class="el" href="ble__dfu_8h_source.html#l00143">ble_dfu_s::evt_handler</a>, <a class="el" href="ble__dfu_8h_source.html#l00156">ble_dfu_init_t::evt_handler</a>, <a class="el" href="ble__dfu_8c_source.html#l00046">m_is_dfu_service_initialized</a>, <a class="el" href="nrf__error_8h_source.html#l00042">NRF_ERROR_NULL</a>, <a class="el" href="nrf__error_8h_source.html#l00028">NRF_SUCCESS</a>, <a class="el" href="ble__dfu_8h_source.html#l00137">ble_dfu_s::service_handle</a>, <a class="el" href="ble__types_8h_source.html#l00159">ble_uuid_t::type</a>, <a class="el" href="ble__types_8h_source.html#l00158">ble_uuid_t::uuid</a>, and <a class="el" href="ble__dfu_8h_source.html#l00138">ble_dfu_s::uuid_type</a>.</p>
<div class="fragment"><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> ((p_dfu == NULL) || (p_dfu_init == NULL) || (p_dfu_init-&gt;<a class="code" href="structble__dfu__init__t.html#a11147a19adf77be7ac28efef09fd6d69">evt_handler</a> == NULL))</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__nrf__error.html#gaf6e08e45224ec612e6c95660eb1bcfa0" title="Null Pointer. ">NRF_ERROR_NULL</a>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a0d5ffe38d68e48d81e61fc6a4999ae68">conn_handle</a> = <a class="code" href="group___b_l_e___c_o_n_n___h_a_n_d_l_e_s.html#gacf227b9b101dbcf08eccbbaba54e48f5">BLE_CONN_HANDLE_INVALID</a>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="structble__uuid__t.html" title="Bluetooth Low Energy UUID type, encapsulates both 16-bit and 128-bit UUIDs. ">ble_uuid_t</a> service_uuid;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    uint32_t   err_code;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keyword">const</span> <a class="code" href="structble__uuid128__t.html" title="128 bit UUID values. ">ble_uuid128_t</a> base_uuid128 =</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            0x23, 0xD1, 0xBC, 0xEA, 0x5F, 0x78, 0x23, 0x15,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            0xDE, 0xEF, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    };</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    service_uuid.<a class="code" href="structble__uuid__t.html#aaa1ded1f77a9c12a196ed4ba2ce5f95d">uuid</a> = <a class="code" href="group__ble__sdk__srv__dfu.html#ga1e7a6fccfdd1670cff7559b4f9e86dab">BLE_DFU_SERVICE_UUID</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    err_code = sd_ble_uuid_vs_add(&amp;base_uuid128, &amp;(service_uuid.<a class="code" href="structble__uuid__t.html#a1d127017fb298b889f4ba24752d08b8e">type</a>));</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (err_code != <a class="code" href="group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123" title="Successful command. ">NRF_SUCCESS</a>)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">return</span> err_code;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    err_code = sd_ble_gatts_service_add(<a class="code" href="group___b_l_e___g_a_t_t_s___s_r_v_c___t_y_p_e_s.html#ga881b91f3ac789bf6fcefee7f815dcf7e">BLE_GATTS_SRVC_TYPE_PRIMARY</a>,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                        &amp;service_uuid,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                        &amp;(p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a363e00d9262febd8d752ed2f933be1e4">service_handle</a>));</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> (err_code != <a class="code" href="group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123" title="Successful command. ">NRF_SUCCESS</a>)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">return</span> err_code;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a72397dca62a7f7a53fdaf3c61035ba41">uuid_type</a> = service_uuid.<a class="code" href="structble__uuid__t.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    err_code = <a class="code" href="ble__dfu_8c.html#a9b400a51f3a88bea319da330a36927a5" title="Function for adding DFU Packet characteristic to the BLE Stack. ">dfu_pkt_char_add</a>(p_dfu);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (err_code != <a class="code" href="group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123" title="Successful command. ">NRF_SUCCESS</a>)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">return</span> err_code;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    err_code = <a class="code" href="ble__dfu_8c.html#a02516a17062ea0b4ed026a9100f84d8f" title="Function for adding DFU Control Point characteristic to the BLE Stack. ">dfu_ctrl_pt_add</a>(p_dfu);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (err_code != <a class="code" href="group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123" title="Successful command. ">NRF_SUCCESS</a>)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">return</span> err_code;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    err_code = <a class="code" href="ble__dfu_8c.html#adc45e443625d2d90271c3c21400ca44a" title="Function for adding DFU Revision characteristic to the BLE Stack. ">dfu_rev_char_add</a>(p_dfu, p_dfu_init);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (err_code != <a class="code" href="group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123" title="Successful command. ">NRF_SUCCESS</a>)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">return</span> err_code;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a11147a19adf77be7ac28efef09fd6d69">evt_handler</a> = p_dfu_init-&gt;<a class="code" href="structble__dfu__init__t.html#a11147a19adf77be7ac28efef09fd6d69">evt_handler</a>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span> (p_dfu_init-&gt;<a class="code" href="structble__dfu__init__t.html#a893a7b5845beb42d9e5b650fd012f7f1">error_handler</a> != NULL)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a893a7b5845beb42d9e5b650fd012f7f1">error_handler</a> = p_dfu_init-&gt;<a class="code" href="structble__dfu__init__t.html#a893a7b5845beb42d9e5b650fd012f7f1">error_handler</a>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="ble__dfu_8c.html#af8180dc7ea87699c9f207fa468f43d32">m_is_dfu_service_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123" title="Successful command. ">NRF_SUCCESS</a>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad7ddce358287772b50ae654138ff3ac5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ble_dfu_response_send </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *&#160;</td>
          <td class="paramname"><em>p_dfu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__ble__sdk__srv__dfu.html#ga8c02cda322aae2f242e2ade7c8284cfc">ble_dfu_procedure_t</a>&#160;</td>
          <td class="paramname"><em>dfu_proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__ble__sdk__srv__dfu.html#ga4373c9bf123c0fd7858aac7a75923a81">ble_dfu_resp_val_t</a>&#160;</td>
          <td class="paramname"><em>resp_val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for sending response to a control point command. </p>
<p>This function will encode a DFU Control Point response using the given input parameters and will send a notification of the same to the peer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dfu</td><td>Pointer to the DFU service structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dfu_proc</td><td>Procedure for which this response is to be sent. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resp_val</td><td>Response value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NRF_SUCCESS if the DFU Service has successfully requested the S110 SoftDevice to send the notification. Otherwise an error code. This function returns NRF_ERROR_INVALID_STATE if the device is not connected to a peer or if the DFU service is not initialized or if the notification of the DFU Status Report characteristic was not enabled by the peer. It returns NRF_ERROR_NULL if the pointer p_dfu is NULL. </dd></dl>

<p>Definition at line <a class="el" href="ble__dfu_8c_source.html#l00620">620</a> of file <a class="el" href="ble__dfu_8c_source.html">ble_dfu.c</a>.</p>

<p>References <a class="el" href="ble__types_8h_source.html#l00027">BLE_CONN_HANDLE_INVALID</a>, <a class="el" href="ble__gatt_8h_source.html#l00058">BLE_GATT_HVX_NOTIFICATION</a>, <a class="el" href="ble__dfu_8h_source.html#l00135">ble_dfu_s::conn_handle</a>, <a class="el" href="ble__dfu_8h_source.html#l00140">ble_dfu_s::dfu_ctrl_pt_handles</a>, <a class="el" href="ble__gatts_8h_source.html#l00204">ble_gatts_hvx_params_t::handle</a>, <a class="el" href="ble__dfu_8c_source.html#l00046">m_is_dfu_service_initialized</a>, <a class="el" href="ble__dfu_8c_source.html#l00047">m_notif_buffer</a>, <a class="el" href="nrf__error_8h_source.html#l00036">NRF_ERROR_INVALID_STATE</a>, <a class="el" href="nrf__error_8h_source.html#l00042">NRF_ERROR_NULL</a>, <a class="el" href="ble__gatts_8h_source.html#l00206">ble_gatts_hvx_params_t::offset</a>, <a class="el" href="ble__dfu_8c_source.html#l00042">OP_CODE_RESPONSE</a>, <a class="el" href="ble__gatts_8h_source.html#l00208">ble_gatts_hvx_params_t::p_data</a>, <a class="el" href="ble__gatts_8h_source.html#l00207">ble_gatts_hvx_params_t::p_len</a>, <a class="el" href="ble__gatts_8h_source.html#l00205">ble_gatts_hvx_params_t::type</a>, and <a class="el" href="ble__gatts_8h_source.html#l00194">ble_gatts_char_handles_t::value_handle</a>.</p>
<div class="fragment"><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;{</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">if</span> (p_dfu == NULL)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__nrf__error.html#gaf6e08e45224ec612e6c95660eb1bcfa0" title="Null Pointer. ">NRF_ERROR_NULL</a>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">if</span> ((p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a0d5ffe38d68e48d81e61fc6a4999ae68">conn_handle</a> == <a class="code" href="group___b_l_e___c_o_n_n___h_a_n_d_l_e_s.html#gacf227b9b101dbcf08eccbbaba54e48f5">BLE_CONN_HANDLE_INVALID</a>) || !<a class="code" href="ble__dfu_8c.html#af8180dc7ea87699c9f207fa468f43d32">m_is_dfu_service_initialized</a>)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__nrf__error.html#gaf0aff2ba7864b34a36b4a96986e1851e" title="Invalid state, operation disallowed in this state. ">NRF_ERROR_INVALID_STATE</a>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="structble__gatts__hvx__params__t.html" title="GATT HVx parameters. ">ble_gatts_hvx_params_t</a> hvx_params;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    uint16_t               index = 0;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index++] = <a class="code" href="ble__dfu_8c.html#af9bdc3014f3d54c426b6d2df10de4960a899a0d6b39311e3a47a6bfa5c2134a5d">OP_CODE_RESPONSE</a>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">// Encode the Request Op code</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index++] = (uint8_t)dfu_proc;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">// Encode the Response Value.</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index++] = (uint8_t)resp_val;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    memset(&amp;hvx_params, 0, <span class="keyword">sizeof</span>(hvx_params));</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#af242d6e3b6108ea75e1eb236e94c8240">handle</a> = p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a092f5f6593ac8b6f17bbbaf72ceaee67">dfu_ctrl_pt_handles</a>.<a class="code" href="structble__gatts__char__handles__t.html#a61c5d051b6f79d08236fae6cf7019e75">value_handle</a>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a1d127017fb298b889f4ba24752d08b8e">type</a>   = <a class="code" href="group___b_l_e___g_a_t_t___h_v_x___t_y_p_e_s.html#gad5784996b45947f6d7f0cb81c9a4c9ed">BLE_GATT_HVX_NOTIFICATION</a>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#ac681806181c80437cfab37335f62ff39">offset</a> = 0;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a05aad1ca0c545a05986893ca0e1ed34f">p_len</a>  = &amp;index;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a8304c4af5da6e830b86d7199dc9a22e6">p_data</a> = <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">return</span> sd_ble_gatts_hvx(p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a0d5ffe38d68e48d81e61fc6a4999ae68">conn_handle</a>, &amp;hvx_params);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaafc505a19500b0f629ff5210ff3e754d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ble_dfu_bytes_rcvd_report </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *&#160;</td>
          <td class="paramname"><em>p_dfu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_of_firmware_bytes_rcvd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for notifying the peer about the number of bytes of firmware data received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dfu</td><td>Pointer to the DFU service structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_of_firmware_bytes_rcvd</td><td>Number of bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NRF_SUCCESS if the DFU Service has successfully requested the S110 SoftDevice to send the notification. Otherwise an error code. This function returns NRF_ERROR_INVALID_STATE if the device is not connected to a peer or if the DFU service is not initialized or if the notification of the DFU Status Report characteristic was not enabled by the peer. It returns NRF_ERROR_NULL if the pointer p_dfu is NULL. </dd></dl>

<p>Definition at line <a class="el" href="ble__dfu_8c_source.html#l00551">551</a> of file <a class="el" href="ble__dfu_8c_source.html">ble_dfu.c</a>.</p>

<p>References <a class="el" href="ble__types_8h_source.html#l00027">BLE_CONN_HANDLE_INVALID</a>, <a class="el" href="ble__dfu_8h_source.html#l00077">BLE_DFU_RESP_VAL_SUCCESS</a>, <a class="el" href="ble__gatt_8h_source.html#l00058">BLE_GATT_HVX_NOTIFICATION</a>, <a class="el" href="ble__dfu_8h_source.html#l00135">ble_dfu_s::conn_handle</a>, <a class="el" href="ble__dfu_8h_source.html#l00140">ble_dfu_s::dfu_ctrl_pt_handles</a>, <a class="el" href="ble__gatts_8h_source.html#l00204">ble_gatts_hvx_params_t::handle</a>, <a class="el" href="ble__dfu_8c_source.html#l00046">m_is_dfu_service_initialized</a>, <a class="el" href="ble__dfu_8c_source.html#l00047">m_notif_buffer</a>, <a class="el" href="nrf__error_8h_source.html#l00036">NRF_ERROR_INVALID_STATE</a>, <a class="el" href="nrf__error_8h_source.html#l00042">NRF_ERROR_NULL</a>, <a class="el" href="ble__gatts_8h_source.html#l00206">ble_gatts_hvx_params_t::offset</a>, <a class="el" href="ble__dfu_8c_source.html#l00040">OP_CODE_IMAGE_SIZE_REQ</a>, <a class="el" href="ble__dfu_8c_source.html#l00042">OP_CODE_RESPONSE</a>, <a class="el" href="ble__gatts_8h_source.html#l00208">ble_gatts_hvx_params_t::p_data</a>, <a class="el" href="ble__gatts_8h_source.html#l00207">ble_gatts_hvx_params_t::p_len</a>, <a class="el" href="ble__gatts_8h_source.html#l00205">ble_gatts_hvx_params_t::type</a>, and <a class="el" href="ble__gatts_8h_source.html#l00194">ble_gatts_char_handles_t::value_handle</a>.</p>
<div class="fragment"><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;{</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> (p_dfu == NULL)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__nrf__error.html#gaf6e08e45224ec612e6c95660eb1bcfa0" title="Null Pointer. ">NRF_ERROR_NULL</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> ((p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a0d5ffe38d68e48d81e61fc6a4999ae68">conn_handle</a> == <a class="code" href="group___b_l_e___c_o_n_n___h_a_n_d_l_e_s.html#gacf227b9b101dbcf08eccbbaba54e48f5">BLE_CONN_HANDLE_INVALID</a>) || !<a class="code" href="ble__dfu_8c.html#af8180dc7ea87699c9f207fa468f43d32">m_is_dfu_service_initialized</a>)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__nrf__error.html#gaf0aff2ba7864b34a36b4a96986e1851e" title="Invalid state, operation disallowed in this state. ">NRF_ERROR_INVALID_STATE</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="structble__gatts__hvx__params__t.html" title="GATT HVx parameters. ">ble_gatts_hvx_params_t</a> hvx_params;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    uint16_t               index = 0;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">// Encode the Op Code.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index++] = <a class="code" href="ble__dfu_8c.html#af9bdc3014f3d54c426b6d2df10de4960a899a0d6b39311e3a47a6bfa5c2134a5d">OP_CODE_RESPONSE</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">// Encode the Reqest Op Code.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index++] = <a class="code" href="ble__dfu_8c.html#af9bdc3014f3d54c426b6d2df10de4960af8a110e6c29f9848d455e57f5b6e864e">OP_CODE_IMAGE_SIZE_REQ</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">// Encode the Response Value.</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index++] = (uint8_t)<a class="code" href="group__ble__sdk__srv__dfu.html#gga4373c9bf123c0fd7858aac7a75923a81a41c5cb143d8b4a872692b0c99078d14d">BLE_DFU_RESP_VAL_SUCCESS</a>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    index += uint32_encode(num_of_firmware_bytes_rcvd, &amp;<a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index]);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    memset(&amp;hvx_params, 0, <span class="keyword">sizeof</span>(hvx_params));</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#af242d6e3b6108ea75e1eb236e94c8240">handle</a> = p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a092f5f6593ac8b6f17bbbaf72ceaee67">dfu_ctrl_pt_handles</a>.<a class="code" href="structble__gatts__char__handles__t.html#a61c5d051b6f79d08236fae6cf7019e75">value_handle</a>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a1d127017fb298b889f4ba24752d08b8e">type</a>   = <a class="code" href="group___b_l_e___g_a_t_t___h_v_x___t_y_p_e_s.html#gad5784996b45947f6d7f0cb81c9a4c9ed">BLE_GATT_HVX_NOTIFICATION</a>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#ac681806181c80437cfab37335f62ff39">offset</a> = 0;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a05aad1ca0c545a05986893ca0e1ed34f">p_len</a>  = &amp;index;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a8304c4af5da6e830b86d7199dc9a22e6">p_data</a> = <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">return</span> sd_ble_gatts_hvx(p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a0d5ffe38d68e48d81e61fc6a4999ae68">conn_handle</a>, &amp;hvx_params);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadf6fde821bd72c16b61442d0627f4e50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ble_dfu_pkts_rcpt_notify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ble__sdk__srv__dfu.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *&#160;</td>
          <td class="paramname"><em>p_dfu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_of_firmware_bytes_rcvd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for sending Packet Receipt Notification to the peer. </p>
<pre class="fragment">        This function will encode the number of bytes received as input parameter into a
        notification of the control point characteristic and send it to the peer.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dfu</td><td>Pointer to the DFU service structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_of_firmware_bytes_rcvd</td><td>Number of bytes of firmware image received.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NRF_SUCCESS if the DFU Service has successfully requested the S110 SoftDevice to send the notification. Otherwise an error code. This function returns NRF_ERROR_INVALID_STATE if the device is not connected to a peer or if the DFU service is not initialized or if the notification of the DFU Status Report characteristic was not enabled by the peer. It returns NRF_ERROR_NULL if the pointer p_dfu is NULL. </dd></dl>

<p>Definition at line <a class="el" href="ble__dfu_8c_source.html#l00589">589</a> of file <a class="el" href="ble__dfu_8c_source.html">ble_dfu.c</a>.</p>

<p>References <a class="el" href="ble__types_8h_source.html#l00027">BLE_CONN_HANDLE_INVALID</a>, <a class="el" href="ble__gatt_8h_source.html#l00058">BLE_GATT_HVX_NOTIFICATION</a>, <a class="el" href="ble__dfu_8h_source.html#l00135">ble_dfu_s::conn_handle</a>, <a class="el" href="ble__dfu_8h_source.html#l00140">ble_dfu_s::dfu_ctrl_pt_handles</a>, <a class="el" href="ble__gatts_8h_source.html#l00204">ble_gatts_hvx_params_t::handle</a>, <a class="el" href="ble__dfu_8c_source.html#l00046">m_is_dfu_service_initialized</a>, <a class="el" href="ble__dfu_8c_source.html#l00047">m_notif_buffer</a>, <a class="el" href="nrf__error_8h_source.html#l00036">NRF_ERROR_INVALID_STATE</a>, <a class="el" href="nrf__error_8h_source.html#l00042">NRF_ERROR_NULL</a>, <a class="el" href="ble__gatts_8h_source.html#l00206">ble_gatts_hvx_params_t::offset</a>, <a class="el" href="ble__dfu_8c_source.html#l00043">OP_CODE_PKT_RCPT_NOTIF</a>, <a class="el" href="ble__gatts_8h_source.html#l00208">ble_gatts_hvx_params_t::p_data</a>, <a class="el" href="ble__gatts_8h_source.html#l00207">ble_gatts_hvx_params_t::p_len</a>, <a class="el" href="ble__gatts_8h_source.html#l00205">ble_gatts_hvx_params_t::type</a>, and <a class="el" href="ble__gatts_8h_source.html#l00194">ble_gatts_char_handles_t::value_handle</a>.</p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;{</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">if</span> (p_dfu == NULL)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__nrf__error.html#gaf6e08e45224ec612e6c95660eb1bcfa0" title="Null Pointer. ">NRF_ERROR_NULL</a>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">if</span> ((p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a0d5ffe38d68e48d81e61fc6a4999ae68">conn_handle</a> == <a class="code" href="group___b_l_e___c_o_n_n___h_a_n_d_l_e_s.html#gacf227b9b101dbcf08eccbbaba54e48f5">BLE_CONN_HANDLE_INVALID</a>) || !<a class="code" href="ble__dfu_8c.html#af8180dc7ea87699c9f207fa468f43d32">m_is_dfu_service_initialized</a>)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__nrf__error.html#gaf0aff2ba7864b34a36b4a96986e1851e" title="Invalid state, operation disallowed in this state. ">NRF_ERROR_INVALID_STATE</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <a class="code" href="structble__gatts__hvx__params__t.html" title="GATT HVx parameters. ">ble_gatts_hvx_params_t</a> hvx_params;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    uint16_t               index = 0;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index++] = <a class="code" href="ble__dfu_8c.html#af9bdc3014f3d54c426b6d2df10de4960a04de45833d50ca8ffa4adfb4a4750a3b">OP_CODE_PKT_RCPT_NOTIF</a>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    index += uint32_encode(num_of_firmware_bytes_rcvd, &amp;<a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>[index]);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    memset(&amp;hvx_params, 0, <span class="keyword">sizeof</span>(hvx_params));</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#af242d6e3b6108ea75e1eb236e94c8240">handle</a> = p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a092f5f6593ac8b6f17bbbaf72ceaee67">dfu_ctrl_pt_handles</a>.<a class="code" href="structble__gatts__char__handles__t.html#a61c5d051b6f79d08236fae6cf7019e75">value_handle</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a1d127017fb298b889f4ba24752d08b8e">type</a>   = <a class="code" href="group___b_l_e___g_a_t_t___h_v_x___t_y_p_e_s.html#gad5784996b45947f6d7f0cb81c9a4c9ed">BLE_GATT_HVX_NOTIFICATION</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#ac681806181c80437cfab37335f62ff39">offset</a> = 0;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a05aad1ca0c545a05986893ca0e1ed34f">p_len</a>  = &amp;index;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    hvx_params.<a class="code" href="structble__gatts__hvx__params__t.html#a8304c4af5da6e830b86d7199dc9a22e6">p_data</a> = <a class="code" href="ble__dfu_8c.html#ae8e4a91a8280429fc73f782255019f1b">m_notif_buffer</a>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">return</span> sd_ble_gatts_hvx(p_dfu-&gt;<a class="code" href="structble__dfu__s.html#a0d5ffe38d68e48d81e61fc6a4999ae68">conn_handle</a>, &amp;hvx_params);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Apr 13 2015 11:33:11 for nRF51822 Beacon Firmware Documentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
